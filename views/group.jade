extends contents-layout
block title
  title 그룹
block preload-script
block global
  if message
    .toast-custom#toast
      span #{message}
block contents-header
block contents
  //- Group Summary Module
  .container.box-lg(style='text-align:center;')
    .row(style="text-align:center;")
      h4.teal-text.text-darken-1(style="font-weight:bold;") #{groupdata.Groupname}
      strong
        span.grey-text.text-darken-3 Since 
        span.teal-text= moment(groupdata.createtime).format("YYYY-MM-DD")
        span.grey-text.text-darken-3  / Created by 
        span.teal-text= (groupdata.creator)
        br
        span.grey-text.text-darken-3 장르 : 
        span.teal-text= (groupdata.Genre)
        span.grey-text.text-darken-3  / 상태 : 
        if groupdata.Finished
          span.red-text 연재 종료
        else
          span.green-text 연재 중
    .row(style="text-align:center;")
      img.circle.profile.z-depth-2#img_profile(src=groupdata.GroupImageURL, onerror="this.src='/image_404.png'", style="width:250px; height:250px;")
    .row(style="text-align:center;")
      .col.s4
        h5.teal-text 독자
        strong #{groupdata.readers}
      .col.s4
        h5.teal-text 작가
        strong #{groupdata.writers}
      .col.s4
        h5.teal-text 길이
        strong 0
        //- 총 글자수 count 하는 모듈
    .row(style="text-align:center;")
      //- 나중에 실시간으로 바꿀것
      h6(style="text-align:center;") 현재 
        span.teal-text.text-darken-1 #{groupdata.writer}
        |  님이 작성 중입니다! (
        span.teal-text.text-darken-1 #{remain_time}
        |  남음)
    form(action='/group', method='post', style='text-align:center;')
      .row
        if(!isjoin)
          .col.s12.m4
            a.btn-large.waves-effect.waves-light(href='/group/joinreader?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 독자되기
          .col.s12.m4
            a.btn-large.waves-effect.waves-light.blue(href='/group/joinwriter?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 작가되기
          .col.s12.m4
            a.btn-large.disabled(style="width:100%; margin-bottom: 10px;") 탈퇴
        else
          if(iswriter)
            .col.s12.m4
              a.btn-large.waves-effect.waves-light(href='/group/bereader?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 독자되기
            .col.s12.m4
              a.btn-large.disabled(style="width:100%; margin-bottom: 10px;") 작가되기
            .col.s12.m4
              a.btn-large.waves-effect.waves-light.red(href='/group/exit?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 탈퇴
          else
            .col.s12.m4
              a.btn-large.disabled(style="width:100%; margin-bottom: 10px;") 독자되기
            .col.s12.m4
              a.btn-large.waves-effect.waves-light.blue(href='/group/bewriter?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 작가되기
            .col.s12.m4
              a.btn-large.waves-effect.waves-light.red(href='/group/exit?groupname='+groupdata.Groupname, style="width:100%; margin-bottom: 10px;") 탈퇴
    hr
    //- Rules
    .row
      h5.teal-text.text-darken-1(style="font-weight:bold;") 그룹 규칙
      .col.s12.m4(style="padding=20px; margin-bottom: 10px;")
        .rule-card.grey.lighten-3
          strong 작성 제한 시간
          br
          span.teal-text #{groupdata.WriteLimit}
      .col.s12.m4(style="padding=20px; margin-bottom: 10px;")
        .rule-card.grey.lighten-3
          strong 투표 제한 시간
          br
          span.teal-text #{groupdata.VoteLimit}
      .col.s12.m4(style="padding=20px; margin-bottom: 10px;")
        .rule-card.grey.lighten-3
          strong 글자 수 제한
          br
          span.teal-text 100-250
    hr
    //- Read Module
    .row
      h5.teal-text.text-darken-1(style="font-weight:bold;") 소설 읽기
      .row(style="text-align: right; padding-right: 20px;")
        a.btn.waves-effect.waves-light.teal.lighten-1(href="#!") 히스토리
      div#readnodes
      .row
        a.btn.waves-effect.waves-light.teal.lighten-1#loadreadbutton(style="width:150px;") 더 보기
      //- .row
      //-   .col.s12
      //-     .card.grey.lighten-3
      //-       .card-content.grey-text.text-darken-3(style="text-align: left;")
      //-         .row(style="margin-bottom: 20px;")
      //-           p Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc elit magna, tincidunt quis nisl id, venenatis tincidunt ligula. Morbi sit amet consectetur ligula. Aliquam ac risus enim. Mauris scelerisque odio vel purus luctus, at eleifend augue porttitor. Phasellus malesuada efficitur elit, id congue nisi ultricies eu. Praesent pulvinar nisl eget venenatis lobortis. Duis mauris diam, fermentum nec quam ut, vestibulum viverra mauris. Sed consequat nibh et porta eleifend. Aliquam erat volutpat. Nulla id nulla nisi. In facilisis neque ut sem malesuada, eget pulvinar odio cursus. Duis scelerisque ipsum eget elit eleifend imperdiet. Nam venenatis nunc et felis volutpat tincidunt. Cras nec enim nibh. Nam a augue id lorem iaculis malesuada at vitae nisl.
      //-         .row(style="text-align: right; padding-right: 20px;")
      //-           img.circle.profile(src="userimages/empty_user.gif", onerror="this.src='image_404.png'", style="width:50px; height:50px; clear:left;")
      //-           .teal-text(style="float:right; margin-left: 20px;")
      //-             strong User.Nickname
      //-             br
      //-             | 2016-XX-XX 
      //-         .row(style="text-align: right;")
      //-             a.btn.btn-small.waves-effect.waves-light.blue.darken-1(href="#!", style="margin-right:5px;") 수정
      //-             a.btn.btn-small.waves-effect.waves-light.orange.darken-1(href="#!", style="margin-right:5px;") 롤백
      //-             a.btn.btn-small.waves-effect.waves-light.red.darken-1(href="#!") 신고
      //- .row
      //-   .col.s12
      //-     .card.grey.lighten-3
      //-       .card-content.grey-text.text-darken-3(style="text-align: left;")
      //-         .row(style="margin-bottom: 20px;")
      //-           p Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc elit magna, tincidunt quis nisl id, venenatis tincidunt ligula. Morbi sit amet consectetur ligula. Aliquam ac risus enim. Mauris scelerisque odio vel purus luctus, at eleifend augue porttitor. Phasellus malesuada efficitur elit, id congue nisi ultricies eu. Praesent pulvinar nisl eget venenatis lobortis. Duis mauris diam, fermentum nec quam ut, vestibulum viverra mauris. Sed consequat nibh et porta eleifend. Aliquam erat volutpat. Nulla id nulla nisi. In facilisis neque ut sem malesuada, eget pulvinar odio cursus. Duis scelerisque ipsum eget elit eleifend imperdiet. Nam venenatis nunc et felis volutpat tincidunt. Cras nec enim nibh. Nam a augue id lorem iaculis malesuada at vitae nisl.
      //-         .row(style="text-align: right; padding-right: 20px;")
      //-           img.circle.profile(src="userimages/empty_user.gif", onerror="this.src='image_404.png'", style="width:50px; height:50px; clear:left;")
      //-           .teal-text(style="float:right; margin-left: 20px;")
      //-             strong User.Nickname
      //-             br
      //-             | 2016-XX-XX 
      //-         .row(style="text-align: right;")
      //-             a.btn.btn-small.waves-effect.waves-light.blue.darken-1(href="#!", style="margin-right:5px;") 수정
      //-             a.btn.btn-small.waves-effect.waves-light.orange.darken-1(href="#!", style="margin-right:5px;") 롤백
      //-             a.btn.btn-small.waves-effect.waves-light.red.darken-1(href="#!") 신고
      //- .row
      //-   .col.s12
      //-     .card.grey.lighten-3
      //-       .card-content.grey-text.text-darken-3(style="text-align: left;")
      //-         .row(style="margin-bottom: 20px;")
      //-           p Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc elit magna, tincidunt quis nisl id, venenatis tincidunt ligula. Morbi sit amet consectetur ligula. Aliquam ac risus enim. Mauris scelerisque odio vel purus luctus, at eleifend augue porttitor. Phasellus malesuada efficitur elit, id congue nisi ultricies eu. Praesent pulvinar nisl eget venenatis lobortis. Duis mauris diam, fermentum nec quam ut, vestibulum viverra mauris. Sed consequat nibh et porta eleifend. Aliquam erat volutpat. Nulla id nulla nisi. In facilisis neque ut sem malesuada, eget pulvinar odio cursus. Duis scelerisque ipsum eget elit eleifend imperdiet. Nam venenatis nunc et felis volutpat tincidunt. Cras nec enim nibh. Nam a augue id lorem iaculis malesuada at vitae nisl.
      //-         .row(style="text-align: right; padding-right: 20px;")
      //-           img.circle.profile(src="userimages/empty_user.gif", onerror="this.src='image_404.png'", style="width:50px; height:50px; clear:left;")
      //-           .teal-text(style="float:right; margin-left: 20px;")
      //-             strong User.Nickname
      //-             br
      //-             | 2016-XX-XX
      //-         .row(style="text-align: right;")
      //-             a.btn.btn-small.waves-effect.waves-light.blue.darken-1(href="#!", style="margin-right:5px;") 수정
      //-             a.btn.btn-small.waves-effect.waves-light.orange.darken-1(href="#!", style="margin-right:5px;") 롤백
      //-             a.btn.btn-small.waves-effect.waves-light.red.darken-1(href="#!") 신고
    //- Write Module 접속자가 작성 turn 일때만 글쓰기 form이 보여야 함
    .row
      h5.blue-text.text-darken-1(style="font-weight:bold;") 당신의 작성 차례입니다!
      form(action='/group/write?groupname='+groupdata.Groupname, method='post')
        .col.s12
          textarea.materialize-textarea#writearea(name='writearea', placeholder='여기에 작성해 주세요!', style="box-sizing:border-box; background-color: #eeeeee; border: 1px solid grey; padding-left: 10px; padding-right: 10px; min-height: 200px;")
        .col.s12
          button.btn-large.waves-effect.waves-light.blue(type='submit', style="width:100%; max-width: 200px;") 단락 추가
    //- Write form end
    hr
    .row
      h5.teal-text.text-darken-1(style="font-weight:bold;") 진행중인 투표
      .row
        .col.s12
          .card.grey.lighten-3
            .card-content.grey-text.text-darken-3
              .row
                span.grey-text.text-darken-3(style="font-size: 1.6em;") 
                  strong 단락 추가
              .row
                .col.s12
                  .vote-container.z-depth-1
                    a.waves-effect.waves-light.vote-up(href="#!", style="width:70%") 찬성 14 (70%)
                    a.waves-effect.waves-light.vote-down(href="#!", style="width:30%") 반대 6 (30%)
              .row(style="text-align:right;")
                | 시작일 : 
                span.teal-text 2016-XX-XX 
                | / 종료일 : 
                span.teal-text 2016-XX-XX
                br
              .row
                a(href="#!", style="color: #00897b; font-size:1.2em; text-decoration: underline; position: absolute; left: 50%; margin-left:-44px; bottom: 15px;") 해당 글 보기
      .row
        .col.s12
          .card.grey.lighten-3
            .card-content.grey-text.text-darken-3
              .row
                span.grey-text.text-darken-3(style="font-size: 1.6em;") 
                  strong 단락 수정
              .row
                .col.s12
                  .vote-container.z-depth-1
                    a.waves-effect.waves-light.vote-up(href="#!", style="width:40%") 찬성 4 (40%)
                    a.waves-effect.waves-light.vote-down(href="#!", style="width:60%") 반대 6 (60%)
              .row(style="text-align:right;")
                | 시작일 : 
                span.teal-text 2016-XX-XX 
                | / 종료일 : 
                span.teal-text 2016-XX-XX
                br
              .row
                a(href="#!", style="color: #00897b; font-size:1.2em; text-decoration: underline; position: absolute; left: 50%; margin-left:-44px; bottom: 15px;") 해당 글 보기
      .row
        .col.s12
          .card.grey.lighten-3
            .card-content.grey-text.text-darken-3
              .row
                span.grey-text.text-darken-3(style="font-size: 1.6em;") 
                  strong 리비전 롤백
              .row
                .col.s12
                  .vote-container.z-depth-1
                    a.waves-effect.waves-light.vote-up(href="#!", style="width:20%") 찬성 2 (20%)
                    a.waves-effect.waves-light.vote-down(href="#!", style="width:80%") 반대 8 (80%)
              .row(style="text-align:right;")
                | 시작일 : 
                span.teal-text 2016-XX-XX 
                | / 종료일 : 
                span.teal-text 2016-XX-XX
                br
              .row
                a(href="#!", style="color: #00897b; font-size:1.2em; text-decoration: underline; position: absolute; left: 50%; margin-left:-44px; bottom: 15px;") 해당 글 보기
      .row
        .col.s12
          .card.grey.lighten-3
            .card-content.grey-text.text-darken-3
              .row
                span.grey-text.text-darken-3(style="font-size: 1.6em;") 
                  strong 완결
              .row
                .col.s12
                  .vote-container.z-depth-1
                    a.waves-effect.waves-light.vote-up(href="#!", style="width:40%") 찬성 4 (40%)
                    a.waves-effect.waves-light.vote-down(href="#!", style="width:60%") 반대 6 (60%)
              .row(style="text-align:right;")
                | 시작일 : 
                span.teal-text 2016-XX-XX 
                | / 종료일 : 
                span.teal-text 2016-XX-XX
                br
              .row
                a(href="#!", style="color: #00897b; font-size:1.2em; text-decoration: underline; position: absolute; left: 50%; margin-left:-44px; bottom: 15px;") 해당 글 보기
      .row
        .col.s12
          .card.grey.lighten-3
            .card-content.grey-text.text-darken-3
              .row
                span.grey-text.text-darken-3(style="font-size: 1.6em;") 
                  strong 단락 추가
              .row
                .col.s12
                  .vote-container.z-depth-1
                    a.waves-effect.waves-light.vote-up(href="#!", style="width:70%") 찬성 1 (10%)
                    a.waves-effect.waves-light.vote-down(href="#!", style="width:30%") 반대 9 (90%)
              .row(style="text-align:right;")
                | 시작일 : 
                span.teal-text 2016-XX-XX 
                | / 종료일 : 
                span.teal-text 2016-XX-XX
                br
              .row
                a(href="#!", style="color: #00897b; font-size:1.2em; text-decoration: underline; position: absolute; left: 50%; margin-left:-44px; bottom: 15px;") 해당 글 보기

block contents-footer
block afterload-script
  //- 토스트 메세지
  script(type="text/javascript", src = 'viewjs/imageloader.js')
  script.
    $(document).ready(function() {
      setTimeout("$('#toast').fadeOut(2000);", 2000);
    });
  //- Write Module
  script(type='text/javascript').
    $('#writearea').trigger('autoresize');
  //- Read Module
  script(type='text/javascript', src='viewjs/loadmorenode.js')
  script(type='text/javascript').
    var numInitialGroup = 3;
    var numIncremental = 4;
    $(loadmore('readnodes', numInitialGroup, '/group/read', '/group/readnode'));
    $( "#loadreadbutton" ).click(function() {
      loadmore('readnodes', numIncremental, '/group/read', '/group/readnode');
    });
